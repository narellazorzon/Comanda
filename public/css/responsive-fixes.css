/**
 * CORRECCIONES RESPONSIVE PARA MÓVIL
 * Soluciona problemas de usabilidad sin cambiar el diseño
 */

/* ========================================
   1. BREAKPOINTS UNIFICADOS
   ======================================== */
:root {
  --mobile-sm: 320px;
  --mobile-md: 375px;
  --mobile-lg: 425px;
  --tablet-sm: 576px;
  --tablet-md: 768px;
  --tablet-lg: 992px;
  --desktop: 1200px;

  /* Tamaños mínimos táctiles (WCAG) */
  --min-touch-target: 44px;
  --min-font-mobile: 14px;
  --min-input-height: 38px;
}

/* ========================================
   2. CORRECCIONES GENERALES
   ======================================== */

/* Prevenir overflow horizontal */
* {
  max-width: 100%;
}

body {
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
}

/* Mejorar legibilidad en móvil */
@media (max-width: 768px) {
  html {
    font-size: 16px !important;
  }

  body {
    line-height: 1.6;
  }
}

/* ========================================
   3. NAVEGACIÓN RESPONSIVE MEJORADA
   ======================================== */

/* Optimizar altura del menú móvil */
@media (max-width: 768px) {
  .nav-menu {
    height: auto !important;
    max-height: calc(100vh - 60px);
    overflow-y: auto;
    padding-bottom: 20px;
  }

  /* Tamaño táctil apropiado para enlaces */
  .nav-link {
    min-height: var(--min-touch-target) !important;
    padding: 12px 20px !important;
    font-size: 16px !important;
    display: flex;
    align-items: center;
    width: 90% !important;
  }

  /* Logo adaptativo */
  .nav-logo img {
    height: 45px !important;
    width: auto !important;
  }

  /* Hamburger más grande */
  .nav-hamburger {
    min-width: var(--min-touch-target) !important;
    min-height: var(--min-touch-target) !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
  }
}

/* Móviles muy pequeños */
@media (max-width: 375px) {
  .nav-logo img {
    height: 40px !important;
  }

  .navbar {
    padding: 0.5rem !important;
  }
}

/* ========================================
   4. TABLAS RESPONSIVE MEJORADAS
   ======================================== */

/* Hacer todas las tablas scrollables horizontalmente */
@media (max-width: 768px) {
  .table-responsive {
    display: block !important;
    width: 100% !important;
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
    position: relative;
  }

  /* Indicador visual de scroll */
  .table-responsive::after {
    content: '→';
    position: absolute;
    top: 50%;
    right: 10px;
    transform: translateY(-50%);
    font-size: 24px;
    color: var(--primary, #fd7e14);
    opacity: 0.6;
    pointer-events: none;
    animation: scrollHint 2s infinite;
  }

  @keyframes scrollHint {
    0%, 100% { transform: translateY(-50%) translateX(0); }
    50% { transform: translateY(-50%) translateX(5px); }
  }

  /* Mantener anchos mínimos pero permitir scroll */
  .table {
    min-width: 600px !important;
    font-size: 14px !important;
  }

  .table th,
  .table td {
    min-width: auto !important;
    white-space: nowrap;
    padding: 8px 10px !important;
  }

  /* Columnas de acciones más compactas */
  .table th:last-child,
  .table td:last-child {
    position: sticky;
    right: 0;
    background: white;
    box-shadow: -2px 0 4px rgba(0,0,0,0.1);
    z-index: 1;
  }
}

/* Vista de cards para móvil (mejorada) */
@media (max-width: 768px) {
  .mobile-cards {
    display: block !important;
    height: auto !important;
  }

  .mobile-card {
    padding: 12px !important;
    margin-bottom: 10px !important;
  }
}

/* ========================================
   5. BOTONES Y CONTROLES TÁCTILES
   ======================================== */

@media (max-width: 768px) {
  /* Tamaño mínimo para todos los botones */
  .btn,
  .btn-sm,
  .btn-action,
  .state-btn,
  .status-filter-btn,
  button,
  [type="button"],
  [type="submit"] {
    min-height: var(--min-touch-target) !important;
    min-width: var(--min-touch-target) !important;
    padding: 10px 16px !important;
    font-size: var(--min-font-mobile) !important;
    line-height: 1.5 !important;
  }

  /* Botones pequeños específicos */
  .btn-sm,
  .btn-action {
    padding: 8px 12px !important;
    font-size: 13px !important;
  }

  /* Botones de icono */
  .btn-icon {
    width: var(--min-touch-target) !important;
    height: var(--min-touch-target) !important;
    padding: 0 !important;
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
  }

  /* Espaciado entre botones */
  .btn + .btn,
  .btn-group > .btn + .btn {
    margin-left: 8px !important;
  }
}

/* ========================================
   6. FORMULARIOS Y INPUTS RESPONSIVE
   ======================================== */

@media (max-width: 768px) {
  /* Altura mínima para inputs */
  input[type="text"],
  input[type="email"],
  input[type="password"],
  input[type="number"],
  input[type="tel"],
  input[type="date"],
  input[type="time"],
  input[type="search"],
  select,
  textarea,
  .form-control,
  .search-input,
  .search-filter input {
    min-height: var(--min-input-height) !important;
    padding: 8px 12px !important;
    font-size: 16px !important; /* Previene zoom en iOS */
    line-height: 1.5 !important;
  }

  /* Select mejorado */
  select {
    background-size: 20px !important;
    padding-right: 35px !important;
  }

  /* Labels más legibles */
  label,
  .form-label {
    font-size: 14px !important;
    margin-bottom: 6px !important;
    font-weight: 500 !important;
  }

  /* Grupos de formulario */
  .form-group,
  .mb-3 {
    margin-bottom: 20px !important;
  }

  /* Filtros de búsqueda */
  .search-input-group {
    flex-direction: column;
    gap: 10px;
  }

  .search-input-group input,
  .search-input-group select {
    width: 100% !important;
  }
}

/* ========================================
   7. CARDS Y GRIDS RESPONSIVE
   ======================================== */

@media (max-width: 768px) {
  /* Grid adaptativo */
  .card-grid,
  .grid-container {
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)) !important;
    gap: 15px !important;
  }

  /* Cards optimizadas */
  .card {
    padding: 15px !important;
  }

  .card-title {
    font-size: 16px !important;
    margin-bottom: 10px !important;
  }

  .card-text {
    font-size: 14px !important;
    line-height: 1.5 !important;
  }

  /* Imágenes en cards */
  .card img,
  .producto-img {
    height: auto !important;
    max-height: 150px !important;
    object-fit: cover !important;
  }
}

@media (max-width: 425px) {
  /* Una sola columna en móviles pequeños */
  .card-grid,
  .grid-container {
    grid-template-columns: 1fr !important;
  }
}

/* ========================================
   8. MODALES RESPONSIVE
   ======================================== */

@media (max-width: 768px) {
  /* Modal fullscreen en móvil */
  .modal,
  .modal-dialog {
    margin: 0 !important;
    max-width: 100% !important;
    height: 100% !important;
  }

  .modal-content {
    height: 100% !important;
    border-radius: 0 !important;
    display: flex;
    flex-direction: column;
  }

  .modal-header {
    flex-shrink: 0;
    padding: 15px !important;
    position: sticky;
    top: 0;
    background: white;
    z-index: 10;
    border-bottom: 2px solid #dee2e6;
  }

  .modal-body {
    flex: 1;
    overflow-y: auto !important;
    padding: 15px !important;
    -webkit-overflow-scrolling: touch;
  }

  .modal-footer {
    flex-shrink: 0;
    padding: 15px !important;
    position: sticky;
    bottom: 0;
    background: white;
    border-top: 2px solid #dee2e6;
  }

  /* Botón de cerrar más grande */
  .modal-header .close,
  .modal-header .btn-close {
    min-width: var(--min-touch-target) !important;
    min-height: var(--min-touch-target) !important;
    font-size: 24px !important;
  }
}

/* ========================================
   9. FILTROS RESPONSIVE
   ======================================== */

@media (max-width: 768px) {
  /* Filtros horizontales con scroll */
  .menu-filters,
  .filter-container {
    display: flex !important;
    overflow-x: auto !important;
    gap: 10px !important;
    padding: 10px 0 !important;
    -webkit-overflow-scrolling: touch !important;
  }

  /* Indicador de scroll visible */
  .menu-filters::-webkit-scrollbar,
  .filter-container::-webkit-scrollbar {
    height: 6px !important;
  }

  .menu-filters::-webkit-scrollbar-track,
  .filter-container::-webkit-scrollbar-track {
    background: #f1f1f1 !important;
    border-radius: 3px !important;
  }

  .menu-filters::-webkit-scrollbar-thumb,
  .filter-container::-webkit-scrollbar-thumb {
    background: var(--primary, #fd7e14) !important;
    border-radius: 3px !important;
  }

  /* Botones de filtro no se comprimen */
  .filter-btn,
  .categoria-filter {
    flex: 0 0 auto !important;
    white-space: nowrap !important;
  }
}

/* ========================================
   10. FOOTER RESPONSIVE
   ======================================== */

@media (max-width: 768px) {
  footer {
    padding: 20px 15px !important;
    text-align: center !important;
  }

  footer p {
    font-size: 14px !important;
    line-height: 1.6 !important;
    margin: 5px 0 !important;
  }
}

/* ========================================
   11. AJUSTES ESPECÍFICOS POR VISTA
   ======================================== */

/* Vista de Mesas */
@media (max-width: 768px) {
  .mesa-grid {
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)) !important;
  }

  .mesa-card {
    padding: 10px !important;
    min-height: 120px !important;
  }
}

/* Vista de Pedidos */
@media (max-width: 768px) {
  .pedido-item {
    padding: 12px !important;
    margin-bottom: 10px !important;
  }

  .pedido-detalle {
    font-size: 14px !important;
  }
}

/* Vista de Cliente */
@media (max-width: 768px) {
  .producto-card {
    padding: 10px !important;
  }

  .producto-precio {
    font-size: 18px !important;
    font-weight: bold !important;
  }

  .cantidad-selector {
    min-height: var(--min-touch-target) !important;
  }

  .cantidad-selector button {
    width: var(--min-touch-target) !important;
    height: var(--min-touch-target) !important;
  }
}

/* ========================================
   12. UTILIDADES RESPONSIVE
   ======================================== */

/* Ocultar en móvil */
@media (max-width: 768px) {
  .hide-mobile {
    display: none !important;
  }
}

/* Mostrar solo en móvil */
@media (min-width: 769px) {
  .show-mobile {
    display: none !important;
  }
}

/* Texto responsive */
@media (max-width: 768px) {
  .text-truncate-mobile {
    max-width: 200px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
}

/* ========================================
   13. ACCESIBILIDAD MEJORADA
   ======================================== */

/* Focus visible mejorado */
@media (max-width: 768px) {
  *:focus {
    outline: 3px solid var(--primary, #fd7e14) !important;
    outline-offset: 2px !important;
  }

  /* Skip link para navegación */
  .skip-link {
    position: absolute;
    top: -40px;
    left: 0;
    background: var(--primary, #fd7e14);
    color: white;
    padding: 8px;
    text-decoration: none;
    z-index: 100;
  }

  .skip-link:focus {
    top: 0;
  }
}

/* ========================================
   14. OPTIMIZACIONES DE PERFORMANCE
   ======================================== */

/* Reducir animaciones en móvil */
@media (max-width: 768px) and (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* ========================================
   15. COMPATIBILIDAD iOS
   ======================================== */

/* Prevenir zoom en inputs en iOS */
@supports (-webkit-touch-callout: none) {
  input[type="text"],
  input[type="email"],
  input[type="password"],
  input[type="number"],
  input[type="tel"],
  input[type="date"],
  input[type="time"],
  input[type="search"],
  select,
  textarea {
    font-size: 16px !important;
  }
}

/* Safe areas para iPhone X+ */
@supports (padding: max(0px)) {
  .navbar,
  .nav-menu,
  footer {
    padding-left: max(15px, env(safe-area-inset-left));
    padding-right: max(15px, env(safe-area-inset-right));
  }

  .modal-header,
  .modal-footer {
    padding-top: max(15px, env(safe-area-inset-top));
    padding-bottom: max(15px, env(safe-area-inset-bottom));
  }
}